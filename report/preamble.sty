% inspired by https://github.com/FagKom/Oppgavemal_2
\ProvidesPackage{preamble}
\usepackage{lipsum} % filltext


% \usepackage{ragged2e}
\usepackage[norsk,UKenglish]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{bookmark}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Font encoding:
\usepackage[defaultsans,oldstyle,scale=0.95]{opensans}
\usepackage[T1]{fontenc}
%\usepackage{lmodern} % font
%\usepackage{bookman} % font
%\usepackage{euler}
\usepackage{csquotes} % quotes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
% \usepackage{physics}
\usepackage{braket}
\usepackage{physics}
\usepackage{siunitx}
\AtBeginDocument{\RenewCommandCopy\qty\SI}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FIGURES
% % TIKZ
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepgfplotslibrary{groupplots,dateplot}
\usetikzlibrary{patterns,shapes.arrows}
\usetikzlibrary{quotes,angles}
\usetikzlibrary{babel}
\pgfplotsset{compat=newest}
\usetikzlibrary{shadows}
\usetikzlibrary{calc}
% \usetikzlibrary{tikzmark}
% \usetikzlibrary{decorations.markings}
% \usetikzlibrary{backgrounds}
% \usetikzlibrary{fadings}}
% }
% \pgfplotsset{
%     tick label style={font=\scriptsize},
%     label style={font=\footnote},
%     every axis legend/.append style={font=\footnotesize},
%     title style={font=\footnotesize},
% }
\pgfplotsset{
  %every axis/.append style={font=\footnotesize},
  every axis label/.append style={font=\footnotesize},
  every x tick label/.append style = {font=\scriptsize},
  every y tick label/.append style = {font=\scriptsize},
  every axis legend/.append style={font=\footnotesize},
  % every axis title/.append style={font=\footnotesize},
}
\pgfplotsset{
  mystyle/.style={
      grid = major,
    },
}

\usepgfplotslibrary{colormaps}


\pgfplotsset{
  colormap/plasma/.style={%
      /pgfplots/colormap={plasma}{%
          rgb=(0.050383, 0.029803, 0.527975)
          rgb=(0.186213, 0.018803, 0.587228)
          rgb=(0.287076, 0.010855, 0.627295)
          rgb=(0.381047, 0.001814, 0.653068)
          rgb=(0.471457, 0.005678, 0.659897)
          rgb=(0.557243, 0.047331, 0.643443)
          rgb=(0.636008, 0.112092, 0.605205)
          rgb=(0.706178, 0.178437, 0.553657)
          rgb=(0.768090, 0.244817, 0.498465)
          rgb=(0.823132, 0.311261, 0.444806)
          rgb=(0.872303, 0.378774, 0.393355)
          rgb=(0.915471, 0.448807, 0.342890)
          rgb=(0.951344, 0.522850, 0.292275)
          rgb=(0.977856, 0.602051, 0.241387)
          rgb=(0.992541, 0.687030, 0.192170)
          rgb=(0.992505, 0.777967, 0.152855)
          rgb=(0.974443, 0.874622, 0.144061)
          rgb=(0.940015, 0.975158, 0.131326)
        },
    },
}

% % RB COLOURS
% \definecolor{blue}{HTML}{01A1DD}
% \definecolor{red}{HTML}{D2273D}
% \definecolor{green}{HTML}{E4C811}
% \definecolor{orange}{HTML}{247F65}

% NTH COLOURS
% \definecolor{blue}{HTML}{6096d0}
% \definecolor{red}{HTML}{ef8114}
% \definecolor{green}{HTML}{bcd025}
% \definecolor{orange}{HTML}{b01b81}

% NTH COLOURS ALT
\definecolor{blue}{HTML}{3cbfbe}
\definecolor{red}{HTML}{b01b81}
\definecolor{green}{HTML}{f7d019}
\definecolor{orange}{HTML}{bcd025}

\pgfplotsset{
  every axis plot/.append style={line width=1pt},
}
% \pgfplotsset{
%     largexnumbers/.style={
%             x tick label style={
%                     /pgf/number format/.cd,
%                     fixed,
%                     fixed zerofill,
%                     precision=1,
%                     sci,/tikz/.cd},
%             scaled x ticks=false,
%         },
% }
\usetikzlibrary{quantikz}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{mathtools}
\usepackage[version=4]{mhchem}
\usepackage{caption}
% \captionsetup[figure]{labelfont=bf}
% \captionsetup[table]{labelfont=bf, position=top}
% \captionsetup{width=0.9\textwidth}
\setkomafont{captionlabel}{\sffamily\bfseries}
\setcapindent{1em}
\usepackage{subcaption}
\usepackage{environ}
\usepackage{bm}

% algorithms
% \usepackage{algorithm}
% \usepackage{algpseudocodex}
\usepackage[
  algochapter,
  algoruled,
  linesnumbered,
  noend,
]{algorithm2e}

\DontPrintSemicolon

\newcommand{\mycapsty}[1]{\sffamily\bfseries\small #1}
% same as above but not bold
% \newcommand{\mycapstygg}[1]{\sffamily\mdseries\small #1}
\SetKwSty{mycapsty}
% \SetKwSty{mycapstygg}
\SetAlCapSty{mycapsty}
\SetNlSty{mycapsty}{}{}

\SetArgSty{text}

\addtotoclist[float]{loa}
\renewcommand\listofalgorithms{\listoftoc[{\listalgorithmcfname}]{loa}}

\makeatletter
\renewcommand*{\@algocf@pre@ruled}{\hrule height\heavyrulewidth depth0pt \kern\belowrulesep}
\renewcommand*{\algocf@caption@ruled}{\box\algocf@capbox\kern\aboverulesep\hrule height\lightrulewidth\kern\belowrulesep}
\renewcommand*{\@algocf@post@ruled}{\kern\aboverulesep\hrule height\heavyrulewidth\relax}
\makeatother

% complexity classes
\usepackage{complexity}



% tables
\usepackage{booktabs}
\usepackage{array}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{nicematrix}
\usepackage{tablefootnote}
\usepackage{ragged2e}  % for '\RaggedRight' macro (allows hyphenation)
\usepackage{tabularray}
\UseTblrLibrary{booktabs}
\UseTblrLibrary{amsmath}
% fix the category code problem
\catcode`&=4
% change the quantikz environment
\ExplSyntaxOn\makeatletter

\RenewDocumentEnvironment{quantikz}{O{} +b}
{
  \tl_set:Nn \l__quantikz_body_tl { \tikzcd@ [#1] #2 }
  \regex_replace_all:nnN { \& } { \cA\& } \l__quantikz_body_tl
  \tl_use:N \l__quantikz_body_tl
  \endtikzcd
}{}
\tl_new:N \l__quantikz_body_tl

\makeatother\ExplSyntaxOff

% ...
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator{\Ima}{Im}
\def\Inf{\operatornamewithlimits{inf\vphantom{p}}} % inf with sup-like spacing


% 
\usepackage{microtype}


% italic front and back matters in toc
\makeatletter
\newcommand\matter@switch{}
\addtokomafont{chapterentry}{\matter@switch}
\g@addto@macro\frontmatter{%
  \addtocontents{toc}{%
    % \protect\renewcommand\protect\matter@switch{\normalfont\itshape}%
    \protect\renewcommand\protect\matter@switch{\itshape}%
  }%
}
\g@addto@macro\mainmatter{%
  \addtocontents{toc}{%
    \protect\renewcommand\protect\matter@switch{}%
  }%
}
\g@addto@macro\backmatter{%
  \addtocontents{toc}{%
    % \protect\renewcommand\protect\matter@switch{\normalfont\itshape}%
    \protect\renewcommand\protect\matter@switch{\itshape}%
  }%
}

% footnotes
\counterwithout{footnote}{chapter}

% chapter heading spacing
\g@addto@macro\frontmatter{%
  \IfChapterUsesPrefixLine{
    % default skips
    \RedeclareSectionCommand[
      beforeskip=1.5cm plus 1cm minus 0.5cm,
      afterskip=1.0cm
    ]{chapter}
  }{
    % else nothing
  }
}%

\g@addto@macro\mainmatter{%
  \IfChapterUsesPrefixLine{
    % vspace 5 cm before chapter
    \RedeclareSectionCommand[
      beforeskip=5.5cm plus 1cm minus 1cm,
      afterskip=1cm,
    ]{chapter}
  }{
    % else nothing
  }
}%

\g@addto@macro\backmatter{%
  \IfChapterUsesPrefixLine{
    % default skips
    \RedeclareSectionCommand[
      beforeskip=1.5cm plus 1cm minus 0.5cm,
      afterskip=1.0cm
    ]{chapter}
  }{
    % else nothing
  }
}%